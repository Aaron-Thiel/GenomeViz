
        <html>
        <head>
            <title>hypothetical protein - Gene Alignment</title>
            <style>
                body {
                    font-family: 'Courier New', monospace;
                    margin: 20px;
                    background-color: #f5f5f5;
                }
                .header {
                    font-family: Arial, sans-serif;
                    background-color: white;
                    padding: 20px;
                    border-radius: 5px;
                    margin-bottom: 20px;
                    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                }
                .alignment-container {
                    background-color: white;
                    padding: 20px;
                    border-radius: 5px;
                    overflow-x: auto;
                    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                }
                .seq-line {
                    margin: 5px 0;
                    white-space: pre;
                    line-height: 1.6;
                }
                .label {
                    display: inline-block;
                    width: 150px;
                    font-weight: bold;
                }
                .match {
                    background-color: #d4edda;
                }
                .mismatch {
                    background-color: #f8d7da;
                    color: #721c24;
                    font-weight: bold;
                }
                .gap {
                    background-color: #fff3cd;
                }
                .missing {
                    background-color: #f8d7da;
                    color: #721c24;
                }
                .stats {
                    margin: 10px 0;
                }
            </style>
        </head>
        <body>
            <div class="header">
                <h1>Gene Alignment: hypothetical protein</h1>
                <div class="stats">
                    <p><b>Position:</b> 432,875 - 433,144 bp</p>
                    <p><b>Length:</b> 270 bp (90 codons)</p>
                    <p><b>Strand:</b> +</p>
                    <p><b>Identity (minimap2):</b> 95.95%</p>
                    <p><b>Coverage:</b> 100.0%</p>
                    <p><b>Quality Score:</b> 97.2/100</p>
                </div>
                <div style="background-color: #e7f3ff; padding: 10px; border-left: 4px solid #2196F3; margin-top: 10px;">
                    <p style="margin: 0; font-size: 13px;"><b>About Identity Calculation:</b></p>
                    <p style="margin: 5px 0 0 0; font-size: 12px;">
                        The <b>minimap2 identity</b> shown above is calculated from the alignment's CIGAR string, which properly accounts for insertions, deletions, and gaps.
                        The alignment below uses the CIGAR string to insert gaps in the correct positions, so the visual alignment should match the identity score.
                    </p>
                </div>
            </div>
        <div class="alignment-container"><div style="background-color: #d1ecf1; padding: 10px; border-left: 4px solid #0c5460; margin-bottom: 15px;"><p style="margin: 0; font-size: 13px; color: #0c5460;"><b>CIGAR-based Alignment - Complete Gene View</b></p><p style="margin: 5px 0 0 0; font-size: 12px; color: #0c5460;">Showing full gene (270 bp). Coverage: 270/270 positions (100.0%). Gaps (-) in assembly indicate missing coverage.</p></div><h2>Amino Acid Alignment</h2><p style="color: #666; font-size: 14px;">Scroll horizontally | Green = match, Red = mismatch, Yellow = gap/indel</p>
        <div style="overflow-x: auto; max-width: 100%; border: 1px solid #dee2e6; padding: 10px; background-color: #f8f9fa;">
            <div class="seq-line"><span class="label">Reference AA:</span> <span class="match">M</span><span class="match">R</span><span class="match">I</span><span class="match">G</span><span class="match">L</span><span class="match">T</span><span class="match">L</span><span class="match">K</span><span class="match">R</span><span class="match">G</span><span class="match">T</span><span class="match">K</span><span class="match">P</span><span class="match">I</span><span class="match">L</span><span class="match">F</span><span class="match">P</span><span class="match">A</span><span class="match">L</span><span class="match">F</span><span class="match">L</span><span class="match">V</span><span class="match">L</span><span class="match">I</span><span class="match">K</span><span class="match">I</span><span class="match">V</span><span class="match">E</span><span class="match">D</span><span class="match">I</span><span class="match">I</span><span class="match">M</span><span class="match">K</span><span class="match">E</span><span class="match">G</span><span class="match">V</span><span class="match">L</span><span class="match">L</span><span class="match">V</span><span class="match">N</span><span class="match">L</span><span class="match">G</span><span class="match">T</span><span class="match">P</span><span class="match">D</span><span class="match">K</span><span class="match">P</span><span class="match">E</span><span class="match">V</span><span class="match">K</span><span class="match">E</span><span class="match">I</span><span class="match">R</span><span class="match">H</span><span class="match">F</span><span class="match">L</span><span class="match">K</span><span class="match">H</span><span class="match">F</span><span class="match">L</span><span class="match">A</span><span class="match">D</span><span class="match">Q</span><span class="match">R</span><span class="match">V</span><span class="match">V</span><span class="match">A</span><span class="match">M</span><span class="match">P</span><span class="match">K</span><span class="match">A</span><span class="match">V</span><span class="match">W</span><span class="match">L</span><span class="match">P</span><span class="match">I</span><span class="match">K</span><span class="match">S</span><span class="match">V</span><span class="match">H</span><span class="match">A</span><span class="match">T</span><span class="match">A</span><span class="match">S</span><span class="match">C</span><span class="match">S</span><span class="match">I</span><span class="match">T</span><span class="match">S</span><span class="match">*</span></div>
            <div class="seq-line"><span class="label">         Match:</span> ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</div>
            <div class="seq-line"><span class="label">Assembly AA:</span> <span class="match">M</span><span class="match">R</span><span class="match">I</span><span class="match">G</span><span class="match">L</span><span class="match">T</span><span class="match">L</span><span class="match">K</span><span class="match">R</span><span class="match">G</span><span class="match">T</span><span class="match">K</span><span class="match">P</span><span class="match">I</span><span class="match">L</span><span class="match">F</span><span class="match">P</span><span class="match">A</span><span class="match">L</span><span class="match">F</span><span class="match">L</span><span class="match">V</span><span class="match">L</span><span class="match">I</span><span class="match">K</span><span class="match">I</span><span class="match">V</span><span class="match">E</span><span class="match">D</span><span class="match">I</span><span class="match">I</span><span class="match">M</span><span class="match">K</span><span class="match">E</span><span class="match">G</span><span class="match">V</span><span class="match">L</span><span class="match">L</span><span class="match">V</span><span class="match">N</span><span class="match">L</span><span class="match">G</span><span class="match">T</span><span class="match">P</span><span class="match">D</span><span class="match">K</span><span class="match">P</span><span class="match">E</span><span class="match">V</span><span class="match">K</span><span class="match">E</span><span class="match">I</span><span class="match">R</span><span class="match">H</span><span class="match">F</span><span class="match">L</span><span class="match">K</span><span class="match">H</span><span class="match">F</span><span class="match">L</span><span class="match">A</span><span class="match">D</span><span class="match">Q</span><span class="match">R</span><span class="match">V</span><span class="match">V</span><span class="match">A</span><span class="match">M</span><span class="match">P</span><span class="match">K</span><span class="match">A</span><span class="match">V</span><span class="match">W</span><span class="match">L</span><span class="match">P</span><span class="match">I</span><span class="match">K</span><span class="match">S</span><span class="match">V</span><span class="match">H</span><span class="match">A</span><span class="match">T</span><span class="match">A</span><span class="match">S</span><span class="match">C</span><span class="match">S</span><span class="match">I</span><span class="match">T</span><span class="match">S</span><span class="match">*</span></div>
            <div style="margin-top: 10px; font-size: 12px; color: #666;">
                <b>Alignment stats:</b> 90 matches, 0 mismatches/gaps out of 90 positions
                (100.00% identity excluding gaps)
            </div>
        </div>
        <h2>Nucleotide Alignment</h2><p style="color: #666; font-size: 14px;">Scroll horizontally | Green = match, Red = mismatch, Yellow = gap/indel</p>
        <div style="overflow-x: auto; max-width: 100%; border: 1px solid #dee2e6; padding: 10px; background-color: #f8f9fa;">
            <div class="seq-line"><span class="label">Reference:</span> <span class="match">A</span><span class="match">T</span><span class="match">G</span><span class="match">C</span><span class="match">G</span><span class="match">G</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">G</span><span class="match">C</span><span class="match">C</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">C</span><span class="match">G</span><span class="match">G</span><span class="match">G</span><span class="match">G</span><span class="match">G</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">C</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">G</span><span class="match">C</span><span class="match">T</span><span class="match">C</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">T</span><span class="match">G</span><span class="match">G</span><span class="match">A</span><span class="match">G</span><span class="match">G</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">T</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">G</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">G</span><span class="match">T</span><span class="match">G</span><span class="match">T</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">G</span><span class="match">G</span><span class="match">G</span><span class="match">A</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">A</span><span class="match">G</span><span class="match">A</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">C</span><span class="match">C</span><span class="match">A</span><span class="match">G</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">T</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">C</span><span class="match">G</span><span class="match">C</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">C</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">G</span><span class="match">C</span><span class="match">T</span><span class="match">G</span><span class="match">A</span><span class="match">T</span><span class="match">C</span><span class="match">A</span><span class="match">G</span><span class="match">C</span><span class="match">G</span><span class="match">G</span><span class="match">G</span><span class="match">T</span><span class="match">C</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">C</span><span class="match">G</span><span class="match">A</span><span class="match">T</span><span class="match">G</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">C</span><span class="match">G</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">G</span><span class="match">C</span><span class="match">T</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">T</span><span class="match">G</span><span class="match">T</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">G</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">G</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">C</span><span class="match">T</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">C</span><span class="match">T</span><span class="match">G</span><span class="match">A</span></div>
            <div class="seq-line"><span class="label">         Match:</span> ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</div>
            <div class="seq-line"><span class="label">Assembly:</span> <span class="match">A</span><span class="match">T</span><span class="match">G</span><span class="match">C</span><span class="match">G</span><span class="match">G</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">G</span><span class="match">C</span><span class="match">C</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">C</span><span class="match">G</span><span class="match">G</span><span class="match">G</span><span class="match">G</span><span class="match">G</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">C</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">G</span><span class="match">C</span><span class="match">T</span><span class="match">C</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">T</span><span class="match">G</span><span class="match">G</span><span class="match">A</span><span class="match">G</span><span class="match">G</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">T</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">G</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">G</span><span class="match">T</span><span class="match">G</span><span class="match">T</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">G</span><span class="match">G</span><span class="match">G</span><span class="match">A</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">A</span><span class="match">G</span><span class="match">A</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">C</span><span class="match">C</span><span class="match">A</span><span class="match">G</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">T</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">C</span><span class="match">G</span><span class="match">C</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">C</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">G</span><span class="match">C</span><span class="match">T</span><span class="match">G</span><span class="match">A</span><span class="match">T</span><span class="match">C</span><span class="match">A</span><span class="match">G</span><span class="match">C</span><span class="match">G</span><span class="match">G</span><span class="match">G</span><span class="match">T</span><span class="match">C</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">C</span><span class="match">G</span><span class="match">A</span><span class="match">T</span><span class="match">G</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">C</span><span class="match">G</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">G</span><span class="match">C</span><span class="match">T</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">T</span><span class="match">G</span><span class="match">T</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">T</span><span class="match">G</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">G</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">T</span><span class="match">T</span><span class="match">G</span><span class="match">C</span><span class="match">T</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">T</span><span class="match">T</span><span class="match">A</span><span class="match">C</span><span class="match">A</span><span class="match">A</span><span class="match">G</span><span class="match">C</span><span class="match">T</span><span class="match">G</span><span class="match">A</span></div>
            <div style="margin-top: 10px; font-size: 12px; color: #666;">
                <b>Alignment stats:</b> 270 matches, 0 mismatches/gaps out of 270 positions
                (100.00% identity excluding gaps)
            </div>
        </div>
        </div>
        
        <style>
        /* Help button styles */
        .help-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #007bff;
            color: white;
            border: none;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            z-index: 9999;
            transition: all 0.3s ease;
        }

        .help-button:hover {
            background-color: #0056b3;
            transform: scale(1.1);
        }

        /* Modal styles */
        .help-modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
        }

        .help-modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 30px;
            border: 1px solid #888;
            border-radius: 8px;
            width: 80%;
            max-width: 700px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            font-family: 'Courier New', monospace;
        }

        .help-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #007bff;
        }

        .help-modal-header h2 {
            margin: 0;
            color: #007bff;
        }

        .help-close {
            color: #aaa;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .help-close:hover,
        .help-close:focus {
            color: #000;
        }

        .help-modal-content h3 {
            color: #333;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .help-modal-content ul {
            line-height: 1.8;
            color: #555;
        }

        .help-modal-content li {
            margin-bottom: 8px;
        }

        .help-modal-content strong {
            color: #007bff;
        }
        </style>

        <!-- Help Button -->
        <button class="help-button" onclick="openHelpModal()" title="Help & Navigation Guide">?</button>

        <!-- Help Modal -->
        <div id="helpModal" class="help-modal">
            <div class="help-modal-content">
                <div class="help-modal-header">
                    <h2>Gene Alignment Guide</h2>
                    <span class="help-close" onclick="closeHelpModal()">&times;</span>
                </div>
                <div class="help-modal-body">
                    
                <h3>Understanding the Alignment</h3>
                <ul>
                    <li><strong>Reference:</strong> The top sequence from the reference genome</li>
                    <li><strong>Assembly:</strong> The bottom sequence from your assembly</li>
                    <li><strong>Match indicators (|):</strong> Show positions where sequences match</li>
                    <li><strong>Gaps (-):</strong> Indicate insertions/deletions or missing coverage</li>
                </ul>

                <h3>Alignment Method</h3>
                <ul>
                    <li><strong>Blue box:</strong> CIGAR-based alignment (accurate gap placement from minimap2)</li>
                    <li><strong>Yellow box:</strong> Fallback alignment (no CIGAR data available)</li>
                </ul>

                <h3>Coverage Statistics</h3>
                <ul>
                    <li><strong>Identity:</strong> Percentage of matching bases (from minimap2)</li>
                    <li><strong>Coverage:</strong> How many positions are covered by assembly alignments</li>
                    <li><strong>Gaps in assembly:</strong> Regions not covered by any alignment</li>
                </ul>

                <h3>Navigation</h3>
                <ul>
                    <li><strong>Scroll horizontally</strong> to view the entire gene sequence</li>
                </ul>
            
                </div>
            </div>
        </div>

        <script>
        function openHelpModal() {
            document.getElementById('helpModal').style.display = 'block';
        }

        function closeHelpModal() {
            document.getElementById('helpModal').style.display = 'none';
        }

        // Close modal when clicking outside of it
        window.onclick = function(event) {
            const modal = document.getElementById('helpModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeHelpModal();
            }
        });
        </script>
        
</body>
        </html>
        